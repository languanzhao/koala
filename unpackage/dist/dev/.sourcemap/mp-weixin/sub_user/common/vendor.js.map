{"version":3,"sources":["uni-app:///common/base64.js"],"names":["getLocalFilePath","path","indexOf","localFilePath","plus","io","convertAbsoluteFileSystem","substr","pathToBase64","Promise","resolve","reject","window","FileReader","xhr","XMLHttpRequest","open","responseType","onload","status","fileReader","e","target","result","onerror","readAsDataURL","response","send","canvas","document","createElement","c2x","getContext","img","Image","width","height","drawImage","toDataURL","src","resolveLocalFileSystemURL","entry","file","data","error","wx","canIUse","getFileSystemManager","readFile","filePath","encoding","success","res","fail","Error","base64ToPath","base64","split","type","match","str","atob","n","length","array","Uint8Array","charCodeAt","URL","webkitURL","createObjectURL","Blob","extName","fileName","Date","now","bitmap","nativeObj","Bitmap","loadBase64Data","save","clear","env","USER_DATA_PATH","writeFile","replace"],"mappings":"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","file":"sub_user/common/vendor.js","sourcesContent":["function getLocalFilePath(path) {\n    if (path.indexOf('_www') === 0 || path.indexOf('_doc') === 0 || path.indexOf('_documents') === 0 || path.indexOf('_downloads') === 0) {\n        return path\n    }\n    if (path.indexOf('file://') === 0) {\n        return path\n    }\n    if (path.indexOf('/storage/emulated/0/') === 0) {\n        return path\n    }\n    if (path.indexOf('/') === 0) {\n        var localFilePath = plus.io.convertAbsoluteFileSystem(path)\n        if (localFilePath !== path) {\n            return localFilePath\n        } else {\n            path = path.substr(1)\n        }\n    }\n    return '_www/' + path\n}\n\nexport function pathToBase64(path) {\n    return new Promise(function(resolve, reject) {\n        if (typeof window === 'object' && 'document' in window) {\n            if (typeof FileReader === 'function') {\n                var xhr = new XMLHttpRequest()\n                xhr.open('GET', path, true)\n                xhr.responseType = 'blob'\n                xhr.onload = function() {\n                    if (this.status === 200) {\n                        let fileReader = new FileReader()\n                        fileReader.onload = function(e) {\n                            resolve(e.target.result)\n                        }\n                        fileReader.onerror = reject\n                        fileReader.readAsDataURL(this.response)\n                    }\n                }\n                xhr.onerror = reject\n                xhr.send()\n                return\n            }\n            var canvas = document.createElement('canvas')\n            var c2x = canvas.getContext('2d')\n            var img = new Image\n            img.onload = function() {\n                canvas.width = img.width\n                canvas.height = img.height\n                c2x.drawImage(img, 0, 0)\n                resolve(canvas.toDataURL())\n                canvas.height = canvas.width = 0\n            }\n            img.onerror = reject\n            img.src = path\n            return\n        }\n        if (typeof plus === 'object') {\n            plus.io.resolveLocalFileSystemURL(getLocalFilePath(path), function(entry) {\n                entry.file(function(file) {\n                    var fileReader = new plus.io.FileReader()\n                    fileReader.onload = function(data) {\n                        resolve(data.target.result)\n                    }\n                    fileReader.onerror = function(error) {\n                        reject(error)\n                    }\n                    fileReader.readAsDataURL(file)\n                }, function(error) {\n                    reject(error)\n                })\n            }, function(error) {\n                reject(error)\n            })\n            return\n        }\n        if (typeof wx === 'object' && wx.canIUse('getFileSystemManager')) {\n            wx.getFileSystemManager().readFile({\n                filePath: path,\n                encoding: 'base64',\n                success: function(res) {\n                    resolve('data:image/png;base64,' + res.data)\n                },\n                fail: function(error) {\n                    reject(error)\n                }\n            })\n            return\n        }\n        reject(new Error('not support'))\n    })\n}\n\nexport function base64ToPath(base64) {\n    return new Promise(function(resolve, reject) {\n        if (typeof window === 'object' && 'document' in window) {\n            base64 = base64.split(',')\n            var type = base64[0].match(/:(.*?);/)[1]\n            var str = atob(base64[1])\n            var n = str.length\n            var array = new Uint8Array(n)\n            while (n--) {\n                array[n] = str.charCodeAt(n)\n            }\n            return resolve((window.URL || window.webkitURL).createObjectURL(new Blob([array], { type: type })))\n        }\n        var extName = base64.match(/data\\:\\S+\\/(\\S+);/)\n        if (extName) {\n            extName = extName[1]\n        } else {\n            reject(new Error('base64 error'))\n        }\n        var fileName = Date.now() + '.' + extName\n        if (typeof plus === 'object') {\n            var bitmap = new plus.nativeObj.Bitmap('bitmap' + Date.now())\n            bitmap.loadBase64Data(base64, function() {\n                var filePath = '_doc/uniapp_temp/' + fileName\n                bitmap.save(filePath, {}, function() {\n                    bitmap.clear()\n                    resolve(filePath)\n                }, function(error) {\n                    bitmap.clear()\n                    reject(error)\n                })\n            }, function(error) {\n                bitmap.clear()\n                reject(error)\n            })\n            return\n        }\n        if (typeof wx === 'object' && wx.canIUse('getFileSystemManager')) {\n            var filePath = wx.env.USER_DATA_PATH + '/' + fileName\n            wx.getFileSystemManager().writeFile({\n                filePath: filePath,\n                data: base64.replace(/^data:\\S+\\/\\S+;base64,/, ''),\n                encoding: 'base64',\n                success: function() {\n                    resolve(filePath)\n                },\n                fail: function(error) {\n                    reject(error)\n                }\n            })\n            return\n        }\n        reject(new Error('not support'))\n    })\n}"],"sourceRoot":""}